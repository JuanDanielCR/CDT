<?xml version="1.0" encoding="UTF-8" ?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
	xmlns:s="/struts-tags" xmlns:sj="/struts-jquery-tags">
	<jsp:directive.page language="java"
		contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" />
	<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<jsp:text>
	<![CDATA[                 
	<script type="text/javascript" src="${pageContext.request.contextPath}/pages/calendario/gestionar-ciclos/js/index.js"></script>
	]]>
</jsp:text>
</head>
<body>
	<!--Gestionar Ciclos Secretaria-->
	<div class="row title">
		<div class="col-md-12">
			<h1 class="title">
				<s:text name="IU1.1-1_TITLE" />
			</h1>
		</div>
	</div>
	<!-- AcctionMessage -->
	<div class="outter-section form-horizontal form-max">
		<div class="row">
			<div class="col-md-12">
				<s:actionerror theme="%{getText('mx.edu.eld.defaulTheme')}" />
				<s:actionmessage theme="%{getText('mx.edu.eld.defaulTheme')}" />
			</div>
		</div>
	</div>
	<!--Muestra Nombe, fecha incio, fecha final y las acciones editar eliminar y agregar actividades de los cilos existentes-->
	<div class="form form-horizontal form-max text-justify">
		<div class="form-group">
			<div class="row">
				<div class="col-md-12">
					<table id="tblGestionarCiclos" class="table table-striped">
						<thead>
							<tr>
								<th data-priority="1"><s:text name="IU1.1-1_LBL1" /></th>
								<th data-priority="3"><s:text name="IU1.1-1_LBL2" /></th>
								<th data-priority="4"><s:text name="IU1.1-1_LBL3" /></th>
								<th data-priority="2"><s:text name="IU1.1-1_LBL4" /></th>
							</tr>
						</thead>
						<tbody>
							<s:iterator value="listCiclo" var="cic">
								<tr>
									<td><s:property value="%{#cic.nombre}" /></td>
									<td id="dtInicio"><s:date name="%{#cic.inicio}"
											format="%{getText('mx.edu.eld.formatDate')}" /></td>
									<td><s:date name="%{#cic.fin}"
											format="%{getText('mx.edu.eld.formatDate')}" /></td>
									<td>
										<!--Sí el ciclo no ha finalizado se mostraran las acciones editar,agregar actividades y eliminar-->
										<s:set var="antesFinal" value="cicloBs.cicloComparar(#cic.fin)"/>
										<s:if test="#antesFinal">
											<a
												href="${pageContext.request.contextPath}/calendario/gestionar-ciclos/${cic.id}/edit">
												<i class="material-icons md-24 md-eld"> &#xE150; </i>
											</a>
											<!--Sí un ciclo tiene actividades puede administrar-->
											<s:if test="%{!#ciclo.eliminable}">
												<a
													href="${pageContext.request.contextPath}/calendario/gestionar-ciclo-actividad?idCicloSel=${cic.id}">
													<i class="material-icons md-24 md-eld"> &#xE8B8; </i>
												</a>
											</s:if>
											<!--Sí un ciclo no esta asociado a una convocatoria o
											     tiene no actividades asicnadas se mostrara la accion
											     eliminar-->
											<s:if test="%{#cic.eliminable and #cic.estatus.id neq 5}">
												<a href="#" onclick="myclickDialog('${cic.id}')"> <i
													class="material-icons md-24 md-eld"> &#xE872; </i>
												</a>
											</s:if>
										</s:if>
									</td>
								</tr>
							</s:iterator>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="outter-section form-medium">
			<div class="row buttons col-md-12">
				<a class="btn btn-default btn-default-eld"
					href="${pageContext.request.contextPath}/calendario/gestionar-ciclos/new">
					<s:text name="btnRegistrarCiclo" />
				</a>
			</div>
		</div>
	</div>

	<sj:dialog id="myclickdialog" modal="true" title="Eliminar Ciclo"
		autoOpen="false" openTopics="showDlgDelete"
		closeTopics="closeDlgDelete" resizable="false" draggable="false">
		<s:url var="urlAction" action="gestionar-ciclos/"
			includeContext="true" />
		<s:hidden id="hdnUrlAction" value="%{#urlAction}" />
		<s:form id="frmEliminarCiclo" action="" theme="simple" method="post">
			<s:hidden name="_method" value="delete" />
			<div class="row">
				<div class="col-md-12">
					<s:text name="IU1.1-1_LBL5" />
				</div>
			</div>
			<!-- Botones de aceptar y cancelar -->
			<div class="row">
				<div class="text-right col-md-12">
					<s:submit cssClass="btn btn-default btn-default-eld"
						value="%{getText('IU1.1-1_LBL6')}" />
					<a onclick="closeDeleteDlg()"
						class="btn btn-default btn-default-eld"><s:text
							name="IU1.1-1_LBL7" /></a>
				</div>
			</div>
		</s:form>
	</sj:dialog>
</body>
	</html>
</jsp:root>